<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{margin:0;font-family:system-ui,-apple-system,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;background:#f6f7f8;color:#222}
    .wrap{max-width:980px;margin:auto;padding:20px}
    h1{margin:0 0 10px;font-size:20px}
    .meta{font-size:13px;color:#555;margin-bottom:10px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{display:inline-block;padding:4px 10px;border:1px solid #ddd;border-radius:999px;background:#fff}
    .card{background:#fff;border-radius:14px;padding:28px;min-height:260px;box-shadow:0 6px 20px rgba(0,0,0,.08);cursor:pointer;user-select:none}
    .label{font-size:12px;letter-spacing:.08em;color:#666;margin-bottom:8px}
    .front{font-size:24px;font-weight:750;line-height:1.45;white-space:pre-wrap}
    .back{font-size:18px;line-height:1.7;white-space:pre-wrap;display:none}
    .controls{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap;align-items:center}
    button{padding:10px 14px;border-radius:10px;border:1px solid #ccc;background:#fff;cursor:pointer;font-size:14px}
    button:hover{background:#f0f0f0}
    .hint{font-size:12px;color:#666;margin-top:8px}
  </style>
</head>

<body>
<div class="wrap">
  <div class="meta">
    <span class="pill" id="countPill"></span>
    <span class="pill" id="progressPill"></span>
    <span class="pill" id="sidePill"></span>
  </div>

  <div class="card" id="card" tabindex="0" role="button" aria-label="Flashcard">
    <div class="label" id="label">問題</div>
    <div class="front" id="front"></div>
    <div class="back" id="back"></div>
  </div>

  <div class="controls">
    <button type="button" onclick="prev()">← 上一題</button>
    <button type="button" onclick="flip()">翻面</button>
    <button type="button" onclick="next()">下一題 →</button>
    <button type="button" onclick="shuffle()">隨機</button>
    <button type="button" onclick="resetOrder()">重設順序</button>
  </div>

  <div class="hint">
    點擊卡片或按 Space 翻面 ｜ ← / → 換題 ｜ S 隨機 ｜ R 重設
  </div>
</div>

<script>
const CARDS = [
  { term: “本書的專利分析實作範例，主要使用哪一種軟體作為操作環境？”, def: “常見且易於取得的Excel軟體。” },
  { term: “在Excel中進行專利分析時，為何通常會保留原始匯入資料，並將各階段處理結果分別存放於不同工作表？”, def: “為了便於後續查驗與比對，因為分析過程常需返回前一階段進行檢視或修正。” },
  { term: “在專利分析的Excel工作表中，每一橫列（row）通常對應什麼？”, def: “一件專利案件。” },
  { term: “在專利分析的Excel工作表中，各項專利欄位資料通常配置在哪裡？”, def: “不同的縱欄（column）中。” },
  { term: “在匯入專利數據後，分析者應養成什麼良好習慣以快速掌握資料整體狀況？”, def: “先進行整體瀏覽與檢視，例如確認橫列與縱欄數量是否與預期相符。” },
  { term: “在Excel中，觀察特定欄位包含哪些不同數據項目的常見功能是什麼？”, def: “使用「資料→篩選」功能。” },
  { term: “專利檢索系統或資料庫最常見提供的三種下載檔案格式為何？”, def: “"Excel檔案 (.xls”, def: “ .xlsx)、CSV檔案 (.csv)、以及TSV檔案 (.tsv)。"“ },
  { term: “當Excel自動匯入CSV或TSV檔案時，可能發生哪兩種主要問題？”, def: “文字亂碼或欄位格式誤判。” },
  { term: “圖4-4案例中，Excel自動匯入CSV檔時，申請號「1.01E+08」是什麼樣的格式誤判？”, def: “Excel將純數字的申請號誤判為數值，並以科學記號形式呈現。” },
  { term: “若要避免Excel自動匯入CSV或TSV檔時發生錯誤，最簡單的解決方式是什麼？”, def: “將檔案副檔名改為Excel無法辨識的「.txt」，以強制啟動「匯入精靈」。” },
  { term: “Excel的「匯入精靈」主要提供哪三項設定？”, def: “(1)欄位分隔符號、(2)資料編碼格式、(3)欄位格式。” },
  { term: “在「匯入精靈」中，Excel的內定欄位格式「通用格式」被標示為什麼？”, def: “「一般」。” },
  { term: “在通用格式下，Excel如何處理看似日期或數字的數據？”, def: “看似日期的以日期格式處理，看似數字的以數值格式處理。” },
  { term: “相較於文字格式，將日期欄位設為日期格式有什麼便利之處？”, def: “Excel可將日期資料自動按年、季、月群組，並可計算兩日期之間的天數。” },
  { term: “為何專利案件的各種號碼欄位（如申請號、證書號）原則上宜採用文字格式？”, def: “為保留原始表示方式，特別是避免前置的零被數值格式自動捨去。” },
  { term: “若將Excel函數（如SUM）輸入到已設定為文字格式的儲存格，會發生什麼情況？”, def: “函數無法被正確運算，只會以原始字串樣貌顯示。” },
  { term: “在Excel中，數值的「7657849」與文字的「7657849」是否被視為相同的數據？”, def: “否，它們被視為兩筆不同的數據，這常是造成查表或比對錯誤的原因。” },
  { term: “在專利分析過程中，存放各類件數小計、比例或平均值的欄位，應確認其格式為_____或_____。”, def: “通用格式、數值格式。” },
  { term: “若資料已匯入工作表且格式已被判定，要重新設定其格式，成功率最高的方法是運用Excel的哪個內建功能？”, def: “「剖析精靈」功能（資料→資料剖析）。” },
  { term: “「匯入精靈」與「剖析精靈」的主要差異在於_____不同。”, def: “運用的時機。” },
  { term: “使用「剖析精靈」僅為了重新指定欄位格式時，應如何設定剖析方式以避免資料被實際拆解？”, def: “選擇以「分隔符號」剖析，但指定一個該欄位資料中不存在的符號。” },
  { term: “在「剖析精靈」中若要將欄位轉為數值格式，應選擇哪個選項？”, def: “應選擇「一般」（即通用格式），讓Excel自動判定其為數值格式。” },
  { term: “要可靠地驗證儲存格是否為數值格式，可以使用哪個Excel內建函數？”, def: “ISNUMBER() 函數。” },
  { term: “要可靠地驗證儲存格是否為文字格式，可以使用哪個Excel內建函數？”, def: “ISTEXT() 函數。” },
  { term: “專利分析實務中，最基本也最關鍵的兩項資料清理工作為何？”, def: “案件篩選與案件去重。” },
  { term: “在專利分析中，所謂「案件篩選」是指什麼？”, def: “依據分析目的與範圍，自匯入資料中選取符合條件的專利案件並排除不符者。” },
  { term: “專利案件篩選最常見的三種方法，是依據欄位資料的_____、_____或_____進行。”, def: “有無、內容、長度。” },
  { term: “在Excel中完成篩選後，為何在複製結果時需使用「特殊目標→可見儲存格」功能？”, def: “因為篩選功能僅是隱藏不符條件的資料列而非刪除，此功能可避免誤將被隱藏的資料列一併複製。” },
  { term: “篩選我國專利中的「公告案」時，若依據欄位資料的有無，可篩選哪個欄位非空白的案件？”, def: “「證書號」或「當前專利權人」欄位。” },
  { term: “若專利號碼末尾帶有文件代碼（kind code），如何利用它篩選出公告案？”, def: “"公告案的文件代碼通常為非A（如B”, def: “ U”, def: “ S），可透過文字篩選「不包含」A來篩選。"“ },
  { term: “利用公開號與公告號的長度差異進行篩選時，通常哪一種號碼的長度較長？”, def: “公開號的長度通常較公告號為長。” },
  { term: “在我國專利申請號中，代表「發明」的案件別代碼是什麼？”, def: “代碼「1」。” },
  { term: “若要篩選申請號中案件別代碼為發明的案件，可使用哪個Excel字串函數擷取代碼？”, def: “MID() 函數，擷取從第4個字元起、長度為1的子字串。” },
  { term: “為何在進行案件篩選時，建議嘗試兩種以上不同的篩選作法進行交叉驗證？”, def: “因為每種方法都基於特定假設，若結果不一致，表示至少有一項假設不成立，需進一步確認。” },
  { term: “在專利分析中，所謂「案件去重」是指什麼？”, def: “針對同一發明申請案可能同時存在的公開案與公告案，僅保留其中一件，以避免數量膨脹。” },
  { term: “案件去重的原則是：若一件發明申請案同時具有公告案與公開案，應保留何者？”, def: “保留該公告案，並排除所有對應的公開案。” },
  { term: “進行案件去重的基礎事實是，同一發明申請案對應的公開案與公告案必然具有相同的_____。”, def: “申請號。” },
  { term: “Excel的「資料→移除重複項」功能在判斷為重複時，會保留哪一列資料？”, def: “自動保留排列在最前面（列號較小）的資料列。” },
  { term: “為了在去重時能正確「保留公告案、排除公開案」，在執行「移除重複項」前必須先進行什麼操作？”, def: “使用「自訂排序」功能，將公告案排列在公開案之前。” },
  { term: “在排序以利去重時，一種相對穩定且可跨多數專利局適用的排序方法，是利用什麼差異進行排序？”, def: “利用公開號與公告號在號碼長度上的差異。” },
  { term: “使用號碼長度進行去重排序時，應將長度較_____者排在前面。”, def: “短（通常為公告案）。” },
  { term: “進行大量案件自動去重時，排序作業應設定哪兩個層級的排序欄位與順序？”, def: “主要層級為「申請號」，次要層級為「號碼長度」（最小到最大）。” },
  { term: “在完成排序後，執行「移除重複項」功能時，應以哪個欄位作為判斷重複的依據？”, def: “「申請號」欄位。” },
  { term: “當專利資料的「申請日」欄位是文字格式時，可以運用哪個Excel函數來擷取年份以進行篩選？”, def: “LEFT() 函數，擷取左邊的四個字元（YYYY）。” },
  { term: “依我國專利編碼規則，公告號第一碼反映專利類型，其中代表發明、新型、設計的字母分別為何？”, def: “I代表發明、M代表新型、D代表設計。” },
  { term: “如何判斷一份Excel專利資料是否已完成去重？”, def: “先依「申請號」排序，再檢查是否有申請號相同的案件相鄰出現，若有則未去重。” },
  { term: “若對已完成去重的資料再做一次去重，是否會造成不良影響？”, def: “否，因為不存在申請號重複的案件，此操作不會移除任何資料，不會有不良影響。” },
  { term: “在Excel中執行「移除重複項」後，若想復原為去重前的狀態，最直接的方法是什麼？”, def: “使用Excel的「復原(Undo)」功能，或關閉檔案而不儲存，再重新開啟原始檔案。” },
  { term: “當同一發明申請案存在多件公開案與一件公告案時，書中所述的自動去重方法能否正確保留公告案並移除所有公開案？”, def: “能，因為排序會將長度最短的公告案置於最前，其餘公開案因申請號相同，在移除重複項時會被刪除。” },
  { term: “當同一發明申請案僅有多件公開案而無公告案時，要如何調整去重方法以保留最早的公開案？”, def: “在自訂排序中，增加第三層級排序，以「公開公告日」或「申請日」為欄位，並設定為「最早到最晚」。” }
];

let order = [...CARDS.keys()];
let i = 0;
let flipped = false;

const front = document.getElementById("front");
const back = document.getElementById("back");
const label = document.getElementById("label");
const countPill = document.getElementById("countPill");
const progressPill = document.getElementById("progressPill");
const sidePill = document.getElementById("sidePill");

function render() {
  countPill.textContent = `${order.length} cards`;
  progressPill.textContent = `第 ${i+1} / ${order.length} 題`;
  sidePill.textContent = flipped ? "答案" : "問題";

  const c = CARDS[order[i]];
  if (flipped) {
    label.textContent = "答案";
    back.textContent = c.def;
    back.style.display = "block";
    front.style.display = "none";
  } else {
    label.textContent = "問題";
    front.textContent = c.term;
    front.style.display = "block";
    back.style.display = "none";
  }
}

function flip() { flipped = !flipped; render(); }
function next() { i = (i + 1) % order.length; flipped = false; render(); }
function prev() { i = (i - 1 + order.length) % order.length; flipped = false; render(); }

function shuffle() {
  // Fisher-Yates
  for (let k = order.length - 1; k > 0; k--) {
    const j = Math.floor(Math.random() * (k + 1));
    [order[k], order[j]] = [order[j], order[k]];
  }
  i = 0; flipped = false; render();
}
function resetOrder() { order = [...CARDS.keys()]; i = 0; flipped = false; render(); }

document.getElementById("card").onclick = flip;
document.addEventListener("keydown", e => {
  const tag = (document.activeElement?.tagName || "").toLowerCase();
  if (tag === "input" || tag === "textarea" || tag === "select") return;

  if (e.key === " ") { e.preventDefault(); flip(); }
  if (e.key === "ArrowRight") next();
  if (e.key === "ArrowLeft") prev();
  if (e.key.toLowerCase() === "s") shuffle();
  if (e.key.toLowerCase() === "r") resetOrder();
});

render();
</script>
</body>
</html>
